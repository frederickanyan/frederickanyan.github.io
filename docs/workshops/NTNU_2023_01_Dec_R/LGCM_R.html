<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Frederick Anyan">
<meta name="dcterms.date" content="2023-11-30">
<title>Frederick Anyan, Ph.D.&nbsp;- Latent Growth Curve Models (LGCM): Applications with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/profile.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Frederick Anyan, Ph.D.</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html" rel="" target="">
 <span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../workshops.html" rel="" target="">
 <span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../quantposts.html" rel="" target="">
 <span class="menu-text">Quant Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/frederickanyan" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/@anyan4usall" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#practical-preliminaries" id="toc-practical-preliminaries" class="nav-link active" data-scroll-target="#practical-preliminaries">Practical preliminaries</a></li>
  <li><a href="#no-growthlinear-and-quadratic-growth-models" id="toc-no-growthlinear-and-quadratic-growth-models" class="nav-link" data-scroll-target="#no-growthlinear-and-quadratic-growth-models">No growth/Linear and Quadratic growth models</a></li>
  <li><a href="#nested-model-comparisons" id="toc-nested-model-comparisons" class="nav-link" data-scroll-target="#nested-model-comparisons">Nested model comparisons</a></li>
  <li><a href="#bilinearsplinepiecewisemultiphase-growth-models" id="toc-bilinearsplinepiecewisemultiphase-growth-models" class="nav-link" data-scroll-target="#bilinearsplinepiecewisemultiphase-growth-models">Bilinear/Spline/Piecewise/Multiphase growth models</a></li>
  <li><a href="#growth-models-with-time--varying-and-invariant-predictors-and-distal-outcomes" id="toc-growth-models-with-time--varying-and-invariant-predictors-and-distal-outcomes" class="nav-link" data-scroll-target="#growth-models-with-time--varying-and-invariant-predictors-and-distal-outcomes">Growth models with time- varying and invariant predictors and distal outcomes</a></li>
  <li><a href="#multiple-group-growth-models" id="toc-multiple-group-growth-models" class="nav-link" data-scroll-target="#multiple-group-growth-models">Multiple group growth models</a></li>
  <li><a href="#nested-model-comparisons-in-the-multigroup-lgcm" id="toc-nested-model-comparisons-in-the-multigroup-lgcm" class="nav-link" data-scroll-target="#nested-model-comparisons-in-the-multigroup-lgcm">Nested model comparisons in the Multigroup LGCM</a></li>
  <li><a href="#test-of-parameter-constraints" id="toc-test-of-parameter-constraints" class="nav-link" data-scroll-target="#test-of-parameter-constraints">Test of parameter constraints</a></li>
  <li><a href="#modelling-co-development-and-multivariate-growth-models" id="toc-modelling-co-development-and-multivariate-growth-models" class="nav-link" data-scroll-target="#modelling-co-development-and-multivariate-growth-models">Modelling co-development and Multivariate growth models</a></li>
  <li><a href="#sequentially-contingent-growth-models" id="toc-sequentially-contingent-growth-models" class="nav-link" data-scroll-target="#sequentially-contingent-growth-models">Sequentially contingent growth models</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Latent Growth Curve Models (LGCM): Applications with R</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Latent Growth Curve Models</div>
    <div class="quarto-category">Dynamic Models</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Frederick Anyan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 30, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><p>Different analysis techniques allow researchers to examine change in outcome variable(s) across time, including regression methods, mean comparisons and repeated measures ANOVA - although with some limitations. A common practice in developmental research is to assess growth trajectory to understand developmental change - how and when it happens, interindividual differences in how and when it happens, as well as why it happens. Structural Equation Modelling (SEM) is a family of related analysis techniques – correlations, regression analyses and factor analyses, using both observed and unobserved (latent) variables to offer a flexible framework for analyzing developmental change in a highly convenient and statistically rigorous framework for applied research in the social, behavioral, and educational sciences.</p>
<p>This workshop will cover basic and advanced longitudinal SEM models using R in a very easy and efficient implementation. To make the workshop more ‘theory- and practice-based’ than ‘equations-based’, the models that will be estimated in this workshop will be guided by the overarching objectives of longitudinal research (see Baltes &amp; Nesselroade, 1979; McArdle, 2012).</p>
<p>References</p>
<ul>
<li>
Baltes, P. B., &amp; Nesselroade, J. R. (1979). History and rationale of longitudinal research. In J. R. Nasselroade &amp; P. B. Baltes (Eds.), Longitudinal research in the study of behaviour and development (pp.&nbsp;1-39). New York: Academic Press.
</li>
<li>
McArdle, J. J. (2012). Foundational issues in the contemporary modeling of longitudinal trajectories. In B. Laursen, T. D. Little, &amp; N. A. Card (Eds.), Handbook of developmental research methods (pp.&nbsp;385-410). New York, NY: The Guilford Press.
</li>
</ul>
<p><a href="Longitudinal_SEM_R_and_Mplus_01_12_2023.pdf">Download Presentation Slides</a></p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Throughout this workshop, we will use only one function from the lavaan package. So, feel at ease even if it is your first time working in the R environment.</p>
</div>
</div>
</div>
<p>Following are models shown in the tab groups</p>
<strong>Tab group 1</strong>
<li>
Model 1: The No growth or Intercept only model.
</li>
<li>
Model 2: The Linear growth model.
</li>
<li>
Model 3: The Quadratic growth model.
</li>
<strong>Tab group 2</strong>
<li>
Model 4_1: Bilinear/Spline/Piecewise/Multiphase model - M1.
</li>
<li>
Model 4_2: Bilinear/Spline/Piecewise/Multiphase model - M2.
</li>
<li>
Model 4_3: Bilinear/Spline/Piecewise/Multiphase model - M3.
</li>
<strong>Tab group 3</strong>
<li>
Model 6: The linear growth model with time invariant covariates.
</li>
<li>
Model 5: The linear growth model with time-varying covariates.
</li>
<li>
Model 7: The linear growth model with time-varying and time invariant covariates.
</li>
<li>
Model 8: The linear growth model with growth factors predicting a distal outcome.
</li>
<strong>Tab group 4</strong>
<li>
Model 9_1: Multiple-group linear growth model - Full Invariance (M1).
</li>
<li>
Model 9_2: Multiple-group linear growth model - Growth factor means freed(M2).
</li>
<li>
Model 9_3: Multiple-group linear growth model - Growth factor means and covariances freed(M3).
</li>
<li>
Model 9_4: Multiple-group linear growth model - Growth factor means, covariances and residual variances freed(M4).
</li>
<strong>Tab group 5</strong>
<li>
Model 10_1: Multivariate or Parallel growth model.
</li>
<li>
Model 10_2: Multivariate or Parallel growth model with autocorrelations.
</li>
<li>
Model 10_3: Multivariate or Parallel growth model with cross domain correlations.
</li>
<strong>Tab group 6</strong>
<li>
Model 11: Sequentially contingent growth model.
</li>
<p><em>You can jump to the growth models by clicking on the options to your right</em></p>
<section id="practical-preliminaries" class="level2"><h2 class="anchored" data-anchor-id="practical-preliminaries">Practical preliminaries</h2>
<p>Load packages</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span><span class="co">#library(haven) #To read dataset into R. </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span>  <span class="co">#For practical preliminaries: univariate and bivariate descriptive stats</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://milanwiedemann.github.io/lcsm/">lcsm</a></span><span class="op">)</span>   <span class="co">#For plotting longitudinal trajectories from wide data set</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span> <span class="co">#For calling sem/cfa/growth functions. We will use the growth() function in the lavaan pacakage, which also has other functions. [See here](https://lavaan.ugent.be)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Read data</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"/Volumes/anyan-1/frederickanyan.github.io/quantpost_data/data.csv"</span><span class="op">)</span></span>
<span><span class="co">#Create new data set with only your main outcome variables</span></span>
<span><span class="va">lonely</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lone1"</span>, <span class="st">"lone2"</span>, <span class="st">"lone3"</span>, <span class="st">"lone4"</span>, <span class="st">"lone5"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#To plot longitudinal trajectories, create a new data set of only your outcome variables with id included</span></span>
<span><span class="va">lonelytrajectory</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"personid"</span>, <span class="st">"lone1"</span>, <span class="st">"lone2"</span>, <span class="st">"lone3"</span>, <span class="st">"lone4"</span>, <span class="st">"lone5"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Examine univariate and bivariate statistics</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Longitudinal plots</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Examine descriptive statistics.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op">(</span><span class="va">lonely</span><span class="op">)</span> <span class="co">#univariate descriptives </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      vars   n mean   sd median trimmed  mad min  max range skew kurtosis   se
lone1    1 398 1.46 0.46   1.32    1.38 0.34   1 3.75  2.75 1.81     3.95 0.02
lone2    2 395 1.47 0.52   1.31    1.38 0.31   1 5.00  4.00 2.22     7.22 0.03
lone3    3 390 1.53 0.52   1.36    1.44 0.37   1 3.78  2.78 1.52     2.27 0.03
lone4    4 413 1.35 0.47   1.22    1.25 0.25   1 4.92  3.92 3.05    12.75 0.02
lone5    5 409 1.32 0.39   1.20    1.24 0.25   1 3.43  2.43 2.45     7.22 0.02</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#bivariate descriptives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">lonely</span>, use<span class="op">=</span><span class="st">'pairwise.complete.obs'</span><span class="op">)</span> <span class="co">#covariance matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           lone1      lone2      lone3      lone4      lone5
lone1 0.21451070 0.14910019 0.09978644 0.08198277 0.05209327
lone2 0.14910019 0.27059267 0.13796998 0.10077467 0.06904941
lone3 0.09978644 0.13796998 0.27223396 0.10690494 0.08475463
lone4 0.08198277 0.10077467 0.10690494 0.21720685 0.07542655
lone5 0.05209327 0.06904941 0.08475463 0.07542655 0.15471723</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">lonely</span>, use<span class="op">=</span><span class="st">'pairwise.complete.obs'</span><span class="op">)</span> <span class="co">#correlation matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          lone1     lone2     lone3     lone4     lone5
lone1 1.0000000 0.6153198 0.4666493 0.3902312 0.3027420
lone2 0.6153198 1.0000000 0.5184437 0.4142563 0.3557064
lone3 0.4666493 0.5184437 1.0000000 0.4944602 0.4240808
lone4 0.3902312 0.4142563 0.4944602 1.0000000 0.4342628
lone5 0.3027420 0.3557064 0.4240808 0.4342628 1.0000000</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#bivariate scatter plots below the diagonal, histograms on the diagonal, and the Pearson correlation above the diagonal.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/pairs.panels.html">pairs.panels</a></span><span class="op">(</span><span class="va">lonely</span>, lm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#lm = TRUE to fit a regression line if needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="LGCM_R_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Explanatory test or how to interpret and use results from practical preliminaries can be found <a href="https://frederickanyan.github.io/quantposts/practical%20prelims/practical.html">here</a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://milanwiedemann.github.io/lcsm/reference/plot_trajectories.html">plot_trajectories</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lonelytrajectory</span>,</span>
<span>                  id_var <span class="op">=</span> <span class="st">"personid"</span>, </span>
<span>                  var_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lone1"</span>, <span class="st">"lone2"</span>, <span class="st">"lone3"</span>, <span class="st">"lone4"</span>, <span class="st">"lone5"</span><span class="op">)</span>,</span>
<span>                  xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Loneliness"</span>,</span>
<span>                  connect_missing <span class="op">=</span> <span class="cn">FALSE</span>,   <span class="co">#Want to plot only complete observations</span></span>
<span>                  random_sample_frac <span class="op">=</span> <span class="fl">0.05</span>, <span class="co">#You can select more or less than 5% of the data by adjusting this</span></span>
<span>                  title_n <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 10 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="LGCM_R_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can plot separate individual trajectories</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://milanwiedemann.github.io/lcsm/reference/plot_trajectories.html">plot_trajectories</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lonelytrajectory</span>,</span>
<span>                  id_var <span class="op">=</span> <span class="st">"personid"</span>, </span>
<span>                  var_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lone1"</span>, <span class="st">"lone2"</span>, <span class="st">"lone3"</span>, <span class="st">"lone4"</span>, <span class="st">"lone5"</span><span class="op">)</span>,</span>
<span>                  xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Loneliness"</span>,</span>
<span>                  connect_missing <span class="op">=</span> <span class="cn">FALSE</span>,   <span class="co">#Want to plot only complete observations</span></span>
<span>                  random_sample_frac <span class="op">=</span> <span class="fl">0.025</span>, <span class="co">#You can select more or less than 5% of the data by adjusting this</span></span>
<span>                  title_n <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">personid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="LGCM_R_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Explanatory text or how to interpret and use results from things to do before fitting growth models to longitudinal data can be found <a href="https://frederickanyan.github.io/quantposts/practical%20prelims/practical.html">here</a></p>
</div>
</div>
</div>
</section><section id="no-growthlinear-and-quadratic-growth-models" class="level2"><h2 class="anchored" data-anchor-id="no-growthlinear-and-quadratic-growth-models">No growth/Linear and Quadratic growth models</h2>
<p>Basic growth models are described here, including the <em>No growth model or the Intercept only model</em> - which is a logical starting point for growth modelling. We want to reject the no growth modelling as it predicts no overall rate of change across time.</p>
<p>The next model is the <em>Linear growth model</em> which predicts a linear rate of change across time. The <em>Quadratic growth model</em> is a non-linear growth model that predicts an overall acceleration or deceleration in the rate of change when controlling for the linear change across time.</p>
<p>Although the <em>Quadratic growth model</em> can be a useful alternative when the <em>Linear growth model</em> fits poorly or there is some degree of non-linearity in the observed data, it can present much interpretation difficulty. The <em>Bilinear/Spline/Piecewise/Multiphase model</em> is a great alternative for fitting non-linear trajectories.</p>
<p>The <em>Latent basis growth model</em> allows the data to define the growth function - discussed in the workshop.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Model 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Model 2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Model 3</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 001_No growth model</span></span>
<span><span class="va">nogrowth</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5'</span></span>
<span><span class="va">fit_nogrowth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">nogrowth</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_nogrowth</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               186.433
  Degrees of freedom                                13
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.607
  Tucker-Lewis Index (TLI)                       0.698

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -814.634
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1643.269
  Bayesian (BIC)                              1669.669
  Sample-size adjusted Bayesian (SABIC)       1647.466

Root Mean Square Error of Approximation:

  RMSEA                                          0.204
  90 Percent confidence interval - lower         0.179
  90 Percent confidence interval - upper         0.230
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.172

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.398    0.018   79.816    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.109    0.010   10.537    0.000
   .lone2             0.142    0.013   11.035    0.000
   .lone3             0.167    0.015   11.279    0.000
   .lone4             0.112    0.011   10.587    0.000
   .lone5             0.092    0.009   10.119    0.000
    i                 0.075    0.008    9.531    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 002_Linear growth model</span></span>
<span><span class="va">linear</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5'</span></span>
<span><span class="va">fit_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">linear</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_linear</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 49 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                                75.244
  Degrees of freedom                                10
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.852
  Tucker-Lewis Index (TLI)                       0.852

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -759.040
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1538.080
  Bayesian (BIC)                              1575.795
  Sample-size adjusted Bayesian (SABIC)       1544.076

Root Mean Square Error of Approximation:

  RMSEA                                          0.143
  90 Percent confidence interval - lower         0.113
  90 Percent confidence interval - upper         0.174
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.097

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s                -0.015    0.002   -6.246    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.466    0.024   62.031    0.000
    s                -0.025    0.004   -5.784    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.059    0.010    5.761    0.000
   .lone2             0.114    0.011   10.114    0.000
   .lone3             0.172    0.015   11.659    0.000
   .lone4             0.114    0.010   11.066    0.000
   .lone5             0.047    0.010    4.929    0.000
    i                 0.139    0.015    9.310    0.000
    s                 0.003    0.001    5.839    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 003_Quadratic growth curve model</span></span>
<span><span class="va">quadratic</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st">           q =~ 0*lone1 + 1*lone2 + 9*lone3 + 16*lone4 + 36*lone5'</span></span>
<span><span class="va">fit_quadratic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">quadratic</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_quadratic</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 76 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                                46.671
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.908
  Tucker-Lewis Index (TLI)                       0.846

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -744.754
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1517.507
  Bayesian (BIC)                              1570.308
  Sample-size adjusted Bayesian (SABIC)       1525.902

Root Mean Square Error of Approximation:

  RMSEA                                          0.145
  90 Percent confidence interval - lower         0.108
  90 Percent confidence interval - upper         0.185
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.998

Standardized Root Mean Square Residual:

  SRMR                                           0.074

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           
  q =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             9.000                           
    lone4            16.000                           
    lone5            36.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s                -0.020    0.009   -2.179    0.029
    q                 0.000    0.001    0.265    0.791
  s ~~                                                
    q                -0.002    0.001   -1.792    0.073

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.446    0.024   60.828    0.000
    s                 0.017    0.014    1.284    0.199
    q                -0.007    0.002   -3.384    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.037    0.014    2.584    0.010
   .lone2             0.118    0.012    9.942    0.000
   .lone3             0.144    0.014   10.115    0.000
   .lone4             0.099    0.011    8.672    0.000
   .lone5             0.099    0.027    3.684    0.000
    i                 0.148    0.019    7.974    0.000
    s                 0.018    0.007    2.697    0.007
    q                 0.000    0.000    0.959    0.337</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="nested-model-comparisons" class="level2"><h2 class="anchored" data-anchor-id="nested-model-comparisons">Nested model comparisons</h2>
<p>Models 1, 2 and 3 can be compared since Models 1 and 2 are nested in (i.e., reduced or constrained forms of) Model 3 (i.e., the full or free model). Model 1 is also a reduced form of Model 2. In this way, the best model to data correspondence can be determined through a Chi squared (<span class="math inline">\(\chi^2\)</span>) difference test or a likelihood ratio test (LRT). If the LRT or the <span class="math inline">\(\chi^2\)</span> difference is significant (<span class="math inline">\(p &lt; .05\)</span>), it means that the full model fits the data significantly better than the reduced or constrained model. Therefore, reject the reduced or constrained model in favor of the full model.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You should only compare models whose fit indices are acceptable. Therefore, in a real scenario, we would not compare Models 1 and 2 since theY do not reach acceptable model fit.</p>
</div>
</div>
</div>
<p>In the examples here, Model 3 is the best model representation of the data (at least, the best fitting model, although the RMSEA and TLI are not good enough). The non-linear growth function in Model 3 reproduces the trajectory observed when examining the mean values in the univariate descriptives. <a href="https://frederickanyan.github.io/quantposts/practical%20prelims/practical.html">see here</a></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#The `anova` function in `lavaan` computes the LRT for nested models.</span></span>
<span><span class="va">compare_no_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_nogrowth</span>, <span class="va">fit_linear</span><span class="op">)</span></span>
<span><span class="va">compare_no_linear</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

             Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit_linear   10 1538.1 1575.8  75.244                                          
fit_nogrowth 13 1643.3 1669.7 186.433     111.19 0.33518       3  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The results (<span class="math inline">\(\chi^2\)</span><sub>(3)</sub> = 111.19, <span class="math inline">\(p &lt; .001\)</span>) show significant difference in model fit between Model 1 (no growth mode, or reduced model) and Model 2 (linear growth, full model). Thus, Model 2, in which the linear growth factor is freely estimated (relative to Model 1) has improved data to model correspondence (or fits better) than Model 1. Therefore, Model 1 or the no growth model is rejected in favor of Model 2, the linear growth model.</p>
<p>All models can also be compared to determine the best fitting of the three models as follows</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#The `anova` function in `lavaan` computes the LRT for nested models.</span></span>
<span><span class="va">compare_no_linear_qua</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_nogrowth</span>, <span class="va">fit_linear</span>, <span class="va">fit_quadratic</span><span class="op">)</span></span>
<span><span class="va">compare_no_linear_qua</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

              Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)
fit_quadratic  6 1517.5 1570.3  46.671                                      
fit_linear    10 1538.1 1575.8  75.244     28.573 0.13834       4  9.546e-06
fit_nogrowth  13 1643.3 1669.7 186.433    111.189 0.33518       3  &lt; 2.2e-16
                 
fit_quadratic    
fit_linear    ***
fit_nogrowth  ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Remember that this is just an example of how to compare nested models, and that you should only compare models whose fit indices are acceptable.</p>
</div>
</div>
</div>
<p>If the LRT or the <span class="math inline">\(\chi^2\)</span> difference test returned a non-significant result (<span class="math inline">\(p &gt; .05\)</span>), then both Models 1 and 2 would be assumed to have no significant difference in model fit and thus, equally fit the data well. In this case, Model 1 (ie., the reduced model) which is a more parsimonious model compared to Model 2 should be selected as the best representation of model to data correspondence.</p>
</section><section id="bilinearsplinepiecewisemultiphase-growth-models" class="level2"><h2 class="anchored" data-anchor-id="bilinearsplinepiecewisemultiphase-growth-models">Bilinear/Spline/Piecewise/Multiphase growth models</h2>
<p>The <em>Quadratic growth curve model</em> is specified by adding a second-order power of time to the <em>Linear growth curve model</em>, which means that there would be a high correlation between the power terms. This can be resolved by centering the intercept growth factor in the middle of the observation, but becomes more difficult when moving to higher-order polynomials. For this reason, it is recommended to examine the data if a <em>Piecewise growth curve model</em> could be an alternative solution. The most common type is the <em>Bilinear growth curve model</em> which joins two linear growth factors. It also goes by the name <em>Spline growth model</em> and <em>Multiphase growth model</em>. They can accommodate different linear or nonlinear growth functions by segmenting the period of observation with a knot point often called <em>transition points</em> when there are theoretical reasons to separate the observations into discrete phases - hence their name <em>Multiphase growth model</em>. For example, they can be used to model developmental changes that occur during pre-school, primary school and high school with transition points at when a child begins primary school and also at when s/he begins high school.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Model 4_1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Model 4_2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Model 4_3</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 004_Bilinear/Spline growth model</span></span>
<span><span class="va">bilinear</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s1 =~ 0*lone1 + 1*lone2 + 3*lone3 + 3*lone4 + 3*lone5</span></span>
<span><span class="st">           s2 =~ 0*lone1 + 0*lone2 + 0*lone3 + 1*lone4 + 3*lone5'</span></span>
<span><span class="va">fit_bilinear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">bilinear</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_bilinear</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 67 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                                40.781
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.921
  Tucker-Lewis Index (TLI)                       0.869

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -741.809
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1511.618
  Bayesian (BIC)                              1564.418
  Sample-size adjusted Bayesian (SABIC)       1520.012

Root Mean Square Error of Approximation:

  RMSEA                                          0.134
  90 Percent confidence interval - lower         0.097
  90 Percent confidence interval - upper         0.175
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.991

Standardized Root Mean Square Residual:

  SRMR                                           0.074

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s1 =~                                               
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             3.000                           
    lone5             3.000                           
  s2 =~                                               
    lone1             0.000                           
    lone2             0.000                           
    lone3             0.000                           
    lone4             1.000                           
    lone5             3.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s1               -0.015    0.005   -2.851    0.004
    s2               -0.019    0.004   -5.012    0.000
  s1 ~~                                               
    s2                0.000    0.002    0.083    0.934

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.444    0.024   61.016    0.000
    s1                0.007    0.008    0.807    0.420
    s2               -0.059    0.008   -7.002    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.046    0.012    3.772    0.000
   .lone2             0.114    0.011   10.134    0.000
   .lone3             0.130    0.016    8.057    0.000
   .lone4             0.106    0.011    9.719    0.000
   .lone5             0.082    0.022    3.665    0.000
    i                 0.140    0.017    8.385    0.000
    s1                0.008    0.002    3.404    0.001
    s2                0.002    0.004    0.571    0.568</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 004_2_Bilinear/Spline growth model - 2</span></span>
<span><span class="va">bilinear_2</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s1 =~ -3*lone1 + -2*lone2 + 0*lone3 + 0*lone4 + 0*lone5</span></span>
<span><span class="st">           s2 =~ 0*lone1 + 0*lone2 + 0*lone3 + 1*lone4 + 3*lone5'</span></span>
<span><span class="va">fit_bilinear_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">bilinear_2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_bilinear_2</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 62 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                                40.781
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.921
  Tucker-Lewis Index (TLI)                       0.869

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -741.809
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1511.618
  Bayesian (BIC)                              1564.418
  Sample-size adjusted Bayesian (SABIC)       1520.012

Root Mean Square Error of Approximation:

  RMSEA                                          0.134
  90 Percent confidence interval - lower         0.097
  90 Percent confidence interval - upper         0.175
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.991

Standardized Root Mean Square Residual:

  SRMR                                           0.074

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s1 =~                                               
    lone1            -3.000                           
    lone2            -2.000                           
    lone3             0.000                           
    lone4             0.000                           
    lone5             0.000                           
  s2 =~                                               
    lone1             0.000                           
    lone2             0.000                           
    lone3             0.000                           
    lone4             1.000                           
    lone5             3.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s1                0.010    0.005    2.009    0.045
    s2               -0.018    0.006   -3.254    0.001
  s1 ~~                                               
    s2                0.000    0.002    0.083    0.934

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.465    0.025   57.734    0.000
    s1                0.007    0.008    0.807    0.420
    s2               -0.059    0.008   -7.002    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.046    0.012    3.772    0.000
   .lone2             0.114    0.011   10.134    0.000
   .lone3             0.130    0.016    8.057    0.000
   .lone4             0.106    0.011    9.719    0.000
   .lone5             0.082    0.022    3.665    0.000
    i                 0.126    0.018    7.130    0.000
    s1                0.008    0.002    3.404    0.001
    s2                0.002    0.004    0.571    0.568</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 004_3_Bilinear/Spline growth model - 3</span></span>
<span><span class="va">bilinear_3</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s1 =~ -3*lone1 + -3*lone2 + -3*lone3 + -2*lone4 + 0*lone5</span></span>
<span><span class="st">           s2 =~ -3*lone1 + -2*lone2 + 0*lone3 + 0*lone4 + 0*lone5'</span></span>
<span><span class="va">fit_bilinear_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">bilinear_3</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_bilinear_3</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 68 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                                40.781
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               451.170
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.921
  Tucker-Lewis Index (TLI)                       0.869

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -741.809
  Loglikelihood unrestricted model (H1)       -721.418
                                                      
  Akaike (AIC)                                1511.618
  Bayesian (BIC)                              1564.418
  Sample-size adjusted Bayesian (SABIC)       1520.012

Root Mean Square Error of Approximation:

  RMSEA                                          0.134
  90 Percent confidence interval - lower         0.097
  90 Percent confidence interval - upper         0.175
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.991

Standardized Root Mean Square Residual:

  SRMR                                           0.074

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s1 =~                                               
    lone1            -3.000                           
    lone2            -3.000                           
    lone3            -3.000                           
    lone4            -2.000                           
    lone5             0.000                           
  s2 =~                                               
    lone1            -3.000                           
    lone2            -2.000                           
    lone3             0.000                           
    lone4             0.000                           
    lone5             0.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s1               -0.012    0.008   -1.377    0.168
    s2                0.011    0.003    3.342    0.001
  s1 ~~                                               
    s2                0.000    0.002    0.083    0.934

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i                 1.288    0.019   68.489    0.000
    s1               -0.059    0.008   -7.002    0.000
    s2                0.007    0.008    0.807    0.420

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.046    0.012    3.772    0.000
   .lone2             0.114    0.011   10.134    0.000
   .lone3             0.130    0.016    8.057    0.000
   .lone4             0.106    0.011    9.719    0.000
   .lone5             0.082    0.022    3.665    0.000
    i                 0.036    0.022    1.637    0.102
    s1                0.002    0.004    0.571    0.568
    s2                0.008    0.002    3.404    0.001</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="growth-models-with-time--varying-and-invariant-predictors-and-distal-outcomes" class="level2"><h2 class="anchored" data-anchor-id="growth-models-with-time--varying-and-invariant-predictors-and-distal-outcomes">Growth models with time- varying and invariant predictors and distal outcomes</h2>
<p>Dynamic predictors that change across time can be incorporated into the growth model to simultaneously estimate the overall rate of change and the change from the time-varying predictors. These dynamic, time-varying predictors account for within-person changes by altering the trajectory of growth in an individual.</p>
<p>Between-person differences in the within-person rate of change can be explained by the inclusion of time invariant predictors such as gender or experimental conditions.</p>
<p>Growth factors can also be hypothesized to predict distal outcomes that are measured after the growth process such as the rate of change in metacognitve therapy predicting recovery status in a 24-month follow up.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Model 5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Model 6</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Model 7</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Model 8</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 005_Linear growth model with time-varying covariates </span></span>
<span><span class="va">timevaryingcov</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st"># Time-varying covariates</span></span>
<span><span class="st">lone1 ~ host1             #lone1 ~ eq*host1</span></span>
<span><span class="st">lone2 ~ host2             #lone2 ~ eq*host2</span></span>
<span><span class="st">lone3 ~ host3             #lone3 ~ eq*host3</span></span>
<span><span class="st">lone4 ~ host4             #lone4 ~ eq*host4</span></span>
<span><span class="st">lone5 ~ host5             #lone5 ~ eq*host5</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Estimate the means of the TVC</span></span>
<span><span class="st">host1 ~ 1</span></span>
<span><span class="st">host2 ~ 1</span></span>
<span><span class="st">host3 ~ 1</span></span>
<span><span class="st">host4 ~ 1</span></span>
<span><span class="st">host5 ~ 1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Estimate covariance between TVC</span></span>
<span><span class="st">host1 ~~ host2 + host3 + host4 + host5</span></span>
<span><span class="st">host2 ~~ host3 + host4 + host5</span></span>
<span><span class="st">host3 ~~ host4 + host5</span></span>
<span><span class="st">host4 ~~ host5'</span></span>
<span></span>
<span><span class="va">fit_timevaryingcov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">timevaryingcov</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_timevaryingcov</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 113 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        35

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               103.191
  Degrees of freedom                                30
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              2956.213
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.975
  Tucker-Lewis Index (TLI)                       0.962

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -659.170
  Loglikelihood unrestricted model (H1)       -607.575
                                                      
  Akaike (AIC)                                1388.340
  Bayesian (BIC)                              1520.341
  Sample-size adjusted Bayesian (SABIC)       1409.326

Root Mean Square Error of Approximation:

  RMSEA                                          0.087
  90 Percent confidence interval - lower         0.069
  90 Percent confidence interval - upper         0.106
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.755

Standardized Root Mean Square Residual:

  SRMR                                           0.059

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lone1 ~                                             
    host1             0.719    0.017   41.813    0.000
  lone2 ~                                             
    host2             0.722    0.014   52.466    0.000
  lone3 ~                                             
    host3             0.738    0.012   63.080    0.000
  lone4 ~                                             
    host4             0.735    0.015   48.645    0.000
  lone5 ~                                             
    host5             0.737    0.022   33.693    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  host1 ~~                                            
    host2             0.161    0.018    8.703    0.000
    host3             0.105    0.018    5.860    0.000
    host4             0.053    0.013    4.153    0.000
    host5             0.036    0.011    3.452    0.001
  host2 ~~                                            
    host3             0.158    0.021    7.358    0.000
    host4             0.079    0.015    5.286    0.000
    host5             0.052    0.012    4.247    0.000
  host3 ~~                                            
    host4             0.120    0.016    7.325    0.000
    host5             0.069    0.013    5.280    0.000
  host4 ~~                                            
    host5             0.064    0.010    6.527    0.000
  i ~~                                                
    s                -0.003    0.001   -4.609    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    host1             1.432    0.028   51.297    0.000
    host2             1.459    0.032   45.207    0.000
    host3             1.535    0.034   45.422    0.000
    host4             1.311    0.025   52.956    0.000
    host5             1.294    0.021   62.524    0.000
    i                 0.414    0.026   15.690    0.000
    s                -0.010    0.007   -1.399    0.162

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.024    0.003    7.834    0.000
   .lone2             0.025    0.003    9.540    0.000
   .lone3             0.038    0.003   11.346    0.000
   .lone4             0.031    0.003   10.917    0.000
   .lone5             0.017    0.003    5.695    0.000
    host1             0.250    0.020   12.669    0.000
    host2             0.334    0.026   12.669    0.000
    host3             0.367    0.029   12.669    0.000
    host4             0.197    0.016   12.669    0.000
    host5             0.138    0.011   12.669    0.000
    i                 0.028    0.003    8.206    0.000
    s                 0.001    0.000    4.757    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 006_Linear growth model with time invariant covariates </span></span>
<span><span class="va">timeinvar</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Time invariant covariates</span></span>
<span><span class="st">i ~ female</span></span>
<span><span class="st">s ~ female'</span></span>
<span><span class="va">fit_timeinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">timeinvar</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_timeinvar</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 55 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12

                                                  Used       Total
  Number of observations                           320         442

Model Test User Model:
                                                      
  Test statistic                                86.716
  Degrees of freedom                                13
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               475.777
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.840
  Tucker-Lewis Index (TLI)                       0.815

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -741.159
  Loglikelihood unrestricted model (H1)       -697.801
                                                      
  Akaike (AIC)                                1506.319
  Bayesian (BIC)                              1551.538
  Sample-size adjusted Bayesian (SABIC)       1513.476

Root Mean Square Error of Approximation:

  RMSEA                                          0.133
  90 Percent confidence interval - lower         0.107
  90 Percent confidence interval - upper         0.160
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.090

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    female           -0.132    0.047   -2.804    0.005
  s ~                                                 
    female            0.007    0.009    0.784    0.433

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.015    0.002   -6.079    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .i                 1.526    0.031   48.551    0.000
   .s                -0.029    0.006   -4.999    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.062    0.010    6.025    0.000
   .lone2             0.112    0.011   10.064    0.000
   .lone3             0.171    0.015   11.628    0.000
   .lone4             0.107    0.010   10.953    0.000
   .lone5             0.051    0.010    5.322    0.000
   .i                 0.134    0.015    9.164    0.000
   .s                 0.003    0.001    5.522    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 007_Linear growth model with time invariant and time-varying covariates </span></span>
<span><span class="va">timeinvartimevar</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">                       s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st"># Time-varying covariates held equal</span></span>
<span><span class="st">lone1 ~ eq*host1</span></span>
<span><span class="st">lone2 ~ eq*host2</span></span>
<span><span class="st">lone3 ~ eq*host3</span></span>
<span><span class="st">lone4 ~ eq*host4</span></span>
<span><span class="st">lone5 ~ eq*host5</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Time invariant covariates</span></span>
<span><span class="st">i ~ female + pdu1 + ace1</span></span>
<span><span class="st">s ~ female + pdu1 + ace1</span></span>
<span><span class="st">    </span></span>
<span><span class="st">#Estimate the means of TVC and TIC</span></span>
<span><span class="st">host1 ~ 1</span></span>
<span><span class="st">host2 ~ 1</span></span>
<span><span class="st">host3 ~ 1</span></span>
<span><span class="st">host4 ~ 1</span></span>
<span><span class="st">host5 ~ 1</span></span>
<span><span class="st">female ~ 1</span></span>
<span><span class="st">pdu1 ~ 1</span></span>
<span><span class="st">ace1 ~ 1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Estimate covariances between TIC with TVC</span></span>
<span><span class="st">ace1 ~~ female + pdu1 + host1 + host2 + host3 + host4 + host5</span></span>
<span><span class="st">female ~~ pdu1 + host1 + host2 + host3 + host4 + host5</span></span>
<span><span class="st">pdu1 ~~ host1 + host2 + host3 + host4 + host5</span></span>
<span><span class="st">host1 ~~ host2 + host3 + host4 + host5</span></span>
<span><span class="st">host2 ~~ host3 + host4 + host5</span></span>
<span><span class="st">host3 ~~ host4 + host5</span></span>
<span><span class="st">host4 ~~ host5</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Fix covariances between TIC and growth factors to zero</span></span>
<span><span class="st">i ~~ 0*host1 </span></span>
<span><span class="st">i ~~ 0*host2 </span></span>
<span><span class="st">i ~~ 0*host3 </span></span>
<span><span class="st">i ~~ 0*host4</span></span>
<span><span class="st">i ~~ 0*host5</span></span>
<span><span class="st"></span></span>
<span><span class="st">s ~~ 0*host1 </span></span>
<span><span class="st">s ~~ 0*host2 </span></span>
<span><span class="st">s ~~ 0*host3 </span></span>
<span><span class="st">s ~~ 0*host4</span></span>
<span><span class="st">s ~~ 0*host5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_timeinvar_timevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">timeinvartimevar</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_timeinvar_timevar</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 117 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        65
  Number of equality constraints                     4

                                                  Used       Total
  Number of observations                           320         442

Model Test User Model:
                                                      
  Test statistic                               102.364
  Degrees of freedom                                43
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              3080.206
  Degrees of freedom                                78
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.980
  Tucker-Lewis Index (TLI)                       0.964

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1389.597
  Loglikelihood unrestricted model (H1)      -1338.415
                                                      
  Akaike (AIC)                                2901.193
  Bayesian (BIC)                              3131.061
  Sample-size adjusted Bayesian (SABIC)       2937.580

Root Mean Square Error of Approximation:

  RMSEA                                          0.066
  90 Percent confidence interval - lower         0.049
  90 Percent confidence interval - upper         0.082
  P-value H_0: RMSEA &lt;= 0.050                    0.056
  P-value H_0: RMSEA &gt;= 0.080                    0.078

Standardized Root Mean Square Residual:

  SRMR                                           0.036

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lone1 ~                                             
    host1     (eq)    0.726    0.011   66.961    0.000
  lone2 ~                                             
    host2     (eq)    0.726    0.011   66.961    0.000
  lone3 ~                                             
    host3     (eq)    0.726    0.011   66.961    0.000
  lone4 ~                                             
    host4     (eq)    0.726    0.011   66.961    0.000
  lone5 ~                                             
    host5     (eq)    0.726    0.011   66.961    0.000
  i ~                                                 
    female           -0.130    0.021   -6.166    0.000
    pdu1              0.006    0.015    0.409    0.683
    ace1              0.082    0.021    3.828    0.000
  s ~                                                 
    female            0.008    0.005    1.752    0.080
    pdu1              0.001    0.003    0.320    0.749
    ace1             -0.003    0.005   -0.713    0.476

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  female ~~                                           
    ace1             -0.002    0.014   -0.168    0.866
  pdu1 ~~                                             
    ace1              0.074    0.021    3.536    0.000
  host1 ~~                                            
    ace1              0.035    0.014    2.480    0.013
  host2 ~~                                            
    ace1              0.053    0.016    3.249    0.001
  host3 ~~                                            
    ace1              0.049    0.017    2.865    0.004
  host4 ~~                                            
    ace1              0.029    0.012    2.391    0.017
  host5 ~~                                            
    ace1              0.047    0.011    4.394    0.000
  female ~~                                           
    pdu1              0.015    0.020    0.719    0.472
  host1 ~~                                            
    female            0.004    0.014    0.256    0.798
  host2 ~~                                            
    female           -0.025    0.016   -1.578    0.114
  host3 ~~                                            
    female            0.007    0.017    0.426    0.670
  host4 ~~                                            
    female            0.008    0.012    0.682    0.495
  host5 ~~                                            
    female           -0.007    0.010   -0.719    0.472
  host1 ~~                                            
    pdu1              0.108    0.021    5.033    0.000
  host2 ~~                                            
    pdu1              0.107    0.024    4.378    0.000
  host3 ~~                                            
    pdu1              0.093    0.025    3.661    0.000
  host4 ~~                                            
    pdu1              0.050    0.018    2.767    0.006
  host5 ~~                                            
    pdu1              0.027    0.015    1.817    0.069
  host1 ~~                                            
    host2             0.161    0.019    8.683    0.000
    host3             0.105    0.018    5.837    0.000
    host4             0.054    0.013    4.345    0.000
    host5             0.037    0.010    3.567    0.000
  host2 ~~                                            
    host3             0.157    0.021    7.330    0.000
    host4             0.082    0.015    5.544    0.000
    host5             0.054    0.012    4.409    0.000
  host3 ~~                                            
    host4             0.124    0.016    7.607    0.000
    host5             0.071    0.013    5.459    0.000
  host4 ~~                                            
    host5             0.059    0.009    6.220    0.000
 .i ~~                                                
    host1             0.000                           
    host2             0.000                           
    host3             0.000                           
    host4             0.000                           
    host5             0.000                           
 .s ~~                                                
    host1             0.000                           
    host2             0.000                           
    host3             0.000                           
    host4             0.000                           
    host5             0.000                           
 .i ~~                                                
   .s                -0.002    0.001   -4.287    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    host1             1.433    0.028   51.188    0.000
    host2             1.460    0.032   45.155    0.000
    host3             1.537    0.034   45.385    0.000
    host4             1.306    0.024   53.812    0.000
    host5             1.291    0.021   62.945    0.000
    female            0.444    0.028   15.978    0.000
    pdu1              2.079    0.041   50.747    0.000
    ace1              1.949    0.028   69.642    0.000
   .i                 0.292    0.049    5.926    0.000
   .s                -0.005    0.010   -0.489    0.625

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.024    0.003    8.113    0.000
   .lone2             0.025    0.003    9.668    0.000
   .lone3             0.038    0.003   11.402    0.000
   .lone4             0.031    0.003   10.955    0.000
   .lone5             0.017    0.003    5.726    0.000
    host1             0.251    0.020   12.649    0.000
    host2             0.335    0.026   12.649    0.000
    host3             0.367    0.029   12.649    0.000
    host4             0.188    0.015   12.649    0.000
    host5             0.135    0.011   12.649    0.000
    female            0.247    0.020   12.649    0.000
    pdu1              0.537    0.042   12.649    0.000
    ace1              0.251    0.020   12.649    0.000
   .i                 0.022    0.003    7.396    0.000
   .s                 0.001    0.000    4.673    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 008_Linear growth model with growth factors predicting distal outcomes </span></span>
<span><span class="va">distal</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">                       s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Regress distal outcome on growth factors</span></span>
<span><span class="st">subs5 ~ i + s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Estimate the intercept of distal outcome (subs5)</span></span>
<span><span class="st">subs5 ~ 1'</span></span>
<span><span class="va">fit_distal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">distal</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_distal</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 62 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                           290         442

Model Test User Model:
                                                      
  Test statistic                                74.672
  Degrees of freedom                                13
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               438.031
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.854
  Tucker-Lewis Index (TLI)                       0.832

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1240.424
  Loglikelihood unrestricted model (H1)      -1203.087
                                                      
  Akaike (AIC)                                2508.847
  Bayesian (BIC)                              2560.226
  Sample-size adjusted Bayesian (SABIC)       2515.829

Root Mean Square Error of Approximation:

  RMSEA                                          0.128
  90 Percent confidence interval - lower         0.101
  90 Percent confidence interval - upper         0.157
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.998

Standardized Root Mean Square Residual:

  SRMR                                           0.086

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  subs5 ~                                             
    i                 0.896    0.398    2.251    0.024
    s                 5.889    3.222    1.828    0.068

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s                -0.015    0.003   -5.793    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .subs5            -0.006    0.539   -0.011    0.991
    i                 1.466    0.025   58.598    0.000
    s                -0.023    0.004   -5.114    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .lone1             0.055    0.011    5.231    0.000
   .lone2             0.118    0.012    9.727    0.000
   .lone3             0.171    0.015   11.052    0.000
   .lone4             0.122    0.012   10.569    0.000
   .lone5             0.052    0.011    4.929    0.000
   .subs5             2.365    0.200   11.825    0.000
    i                 0.142    0.016    8.925    0.000
    s                 0.003    0.001    5.308    0.000</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="multiple-group-growth-models" class="level2"><h2 class="anchored" data-anchor-id="multiple-group-growth-models">Multiple group growth models</h2>
<p>The <em>T 006_Linear growth model with time invariant covariate</em> does not tell us anything about variances and covariances among growth factors, residual variability, and the structure of the within-person changes. A <em>Multiple-group growth model</em> approach offers greater flexibility in explaining between-person differences in the within-person rate of change than the <em>Growth model with time invariant covariate</em>. For example, the Wald test of differences in growth parameters can be tested within the multiple-group approach to explain whether, on average, the experimental group experience greater overall decline than the control group - thus providing insights into how and why individuals differ in their rate of change and by how much difference.</p>
<p>The multiple-group approach can inform about differences in all the growth function parameters - including the growth factors’ means, co/variances and residual variances. Thus, providing information about the differences in the overall rate of change, the extent of variability in the initial status and rate of change as well differences in the extent of fluctuations around individuals own trajectories across the groups.</p>
<p>Take for example, the feeling of loneliness among boys and girls. In addition to investigating <em>significant differences</em> in the predicted outcome at baseline or initial status (i.e., intercept) and rate of overall change (i.e., slope), we can also investigate differences in the amounts of variability at the between and within levels of the growth model and may find that boys show greater variability in the intercept and slope indicating that boys’ trajectories are more different from one another than girls’ trajectories. The structure of within-person changes may also vary such that boys may show slower decline than girls in the feeling of loneliness. We can thus conclude, boys and girls differ in their baseline, and the average growth trajectories of loneliness, the extent of between-person differences in those trajectories and the extent of variability around their individual trajectories.</p>
<p>The multigroup approach can tell us why and how groups of people <em>significantly differ and by how much difference</em> in their trajectories or development over time.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Model 9_1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Model 9_2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Model 9_3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Model 9_4</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 009_1_Multigroup LGCM M1 Invariance model - M1</span></span>
<span><span class="va">multigroupM1</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st">#Growth factor means constrained equal</span></span>
<span><span class="st">i ~ c(int, int)*1</span></span>
<span><span class="st">s ~ c(slp, slp)*1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor variances held equal</span></span>
<span><span class="st">i ~~ c(vint, vint)*i</span></span>
<span><span class="st">s ~~ c(vslp, vslp)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor covariances held equal</span></span>
<span><span class="st">i ~~ c(cvf, cvf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Residual variances of observed items held equal</span></span>
<span><span class="st">lone1 ~~ c(res, res)*lone1</span></span>
<span><span class="st">lone2 ~~ c(res, res)*lone2</span></span>
<span><span class="st">lone3 ~~ c(res, res)*lone3</span></span>
<span><span class="st">lone4 ~~ c(res, res)*lone4</span></span>
<span><span class="st">lone5 ~~ c(res, res)*lone5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_multigroupM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">multigroupM1</span>, data <span class="op">=</span> <span class="va">data</span>, group <span class="op">=</span> <span class="st">"female"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: group variable 'female' contains missing values</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_multigroupM1</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 30 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20
  Number of equality constraints                    14

  Number of observations per group:               Used       Total
    0                                              178         222
    1                                              142         193

Model Test User Model:
                                                      
  Test statistic                               207.477
  Degrees of freedom                                34
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    0                                           98.099
    1                                          109.378

Model Test Baseline Model:

  Test statistic                               463.335
  Degrees of freedom                                20
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.609
  Tucker-Lewis Index (TLI)                       0.770

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -776.723
  Loglikelihood unrestricted model (H1)       -672.984
                                                      
  Akaike (AIC)                                1565.445
  Bayesian (BIC)                              1588.055
  Sample-size adjusted Bayesian (SABIC)       1569.024

Root Mean Square Error of Approximation:

  RMSEA                                          0.179
  90 Percent confidence interval - lower         0.156
  90 Percent confidence interval - upper         0.202
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.230

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s        (cvf)   -0.011    0.002   -4.425    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i        (int)    1.484    0.025   60.198    0.000
    s        (slp)   -0.026    0.004   -5.932    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vint)    0.135    0.016    8.666    0.000
    s       (vslp)    0.001    0.001    2.467    0.014
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000


Group 2 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s        (cvf)   -0.011    0.002   -4.425    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i        (int)    1.484    0.025   60.198    0.000
    s        (slp)   -0.026    0.004   -5.932    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vint)    0.135    0.016    8.666    0.000
    s       (vslp)    0.001    0.001    2.467    0.014
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 009_2_Multigroup LGCM M2 Free factor means - M2</span></span>
<span><span class="va">multigroupM2</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st">#Growth factor means freely estimated</span></span>
<span><span class="st">i ~ c(intm, intf)*1</span></span>
<span><span class="st">s ~ c(slpm, slpf)*1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor variances held equal</span></span>
<span><span class="st">i ~~ c(vint, vint)*i</span></span>
<span><span class="st">s ~~ c(vslp, vslp)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor covariances held equal</span></span>
<span><span class="st">i ~~ c(cvf, cvf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Residual variances of observed items held equal</span></span>
<span><span class="st">lone1 ~~ c(res, res)*lone1</span></span>
<span><span class="st">lone2 ~~ c(res, res)*lone2</span></span>
<span><span class="st">lone3 ~~ c(res, res)*lone3</span></span>
<span><span class="st">lone4 ~~ c(res, res)*lone4</span></span>
<span><span class="st">lone5 ~~ c(res, res)*lone5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_multigroupM2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">multigroupM2</span>, data <span class="op">=</span> <span class="va">data</span>, group <span class="op">=</span> <span class="st">"female"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: group variable 'female' contains missing values</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_multigroupM2</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 34 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20
  Number of equality constraints                    12

  Number of observations per group:               Used       Total
    0                                              178         222
    1                                              142         193

Model Test User Model:
                                                      
  Test statistic                               196.543
  Degrees of freedom                                32
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    0                                           94.352
    1                                          102.191

Model Test Baseline Model:

  Test statistic                               463.335
  Degrees of freedom                                20
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.629
  Tucker-Lewis Index (TLI)                       0.768

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -771.255
  Loglikelihood unrestricted model (H1)       -672.984
                                                      
  Akaike (AIC)                                1558.511
  Bayesian (BIC)                              1588.657
  Sample-size adjusted Bayesian (SABIC)       1563.283

Root Mean Square Error of Approximation:

  RMSEA                                          0.179
  90 Percent confidence interval - lower         0.156
  90 Percent confidence interval - upper         0.204
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.213

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s        (cvf)   -0.010    0.002   -4.331    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intm)    1.550    0.033   47.589    0.000
    s       (slpm)   -0.031    0.006   -5.236    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vint)    0.130    0.015    8.547    0.000
    s       (vslp)    0.001    0.001    2.425    0.015
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000


Group 2 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s        (cvf)   -0.010    0.002   -4.331    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intf)    1.401    0.036   38.400    0.000
    s       (slpf)   -0.020    0.007   -3.062    0.002

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vint)    0.130    0.015    8.547    0.000
    s       (vslp)    0.001    0.001    2.425    0.015
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 009_3_Multigroup LGCM M3 Free factor means and co/variances - M3</span></span>
<span><span class="va">multigroupM3</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st">#Growth factor means freely estimated</span></span>
<span><span class="st">i ~ c(intm, intf)*1</span></span>
<span><span class="st">s ~ c(slpm, slpf)*1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor variances freely estimated</span></span>
<span><span class="st">i ~~ c(vinm, vinf)*i</span></span>
<span><span class="st">s ~~ c(vslm, vslf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor covariances freely estimated</span></span>
<span><span class="st">i ~~ c(covm, covf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Residual variances of observed items held equal</span></span>
<span><span class="st">lone1 ~~ c(res, res)*lone1</span></span>
<span><span class="st">lone2 ~~ c(res, res)*lone2</span></span>
<span><span class="st">lone3 ~~ c(res, res)*lone3</span></span>
<span><span class="st">lone4 ~~ c(res, res)*lone4</span></span>
<span><span class="st">lone5 ~~ c(res, res)*lone5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_multigroupM3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">multigroupM3</span>, data <span class="op">=</span> <span class="va">data</span>, group <span class="op">=</span> <span class="st">"female"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: group variable 'female' contains missing values</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_multigroupM3</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 82 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20
  Number of equality constraints                     9

  Number of observations per group:               Used       Total
    0                                              178         222
    1                                              142         193

Model Test User Model:
                                                      
  Test statistic                               186.447
  Degrees of freedom                                29
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    0                                           90.667
    1                                           95.780

Model Test Baseline Model:

  Test statistic                               463.335
  Degrees of freedom                                20
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.645
  Tucker-Lewis Index (TLI)                       0.755

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -766.208
  Loglikelihood unrestricted model (H1)       -672.984
                                                      
  Akaike (AIC)                                1554.415
  Bayesian (BIC)                              1595.867
  Sample-size adjusted Bayesian (SABIC)       1560.977

Root Mean Square Error of Approximation:

  RMSEA                                          0.184
  90 Percent confidence interval - lower         0.159
  90 Percent confidence interval - upper         0.210
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.177

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s       (covm)   -0.015    0.004   -4.140    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intm)    1.550    0.036   43.187    0.000
    s       (slpm)   -0.031    0.006   -4.949    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vinm)    0.170    0.024    6.957    0.000
    s       (vslm)    0.002    0.001    2.662    0.008
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000


Group 2 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s       (covf)   -0.004    0.003   -1.484    0.138

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intf)    1.401    0.031   44.901    0.000
    s       (slpf)   -0.020    0.006   -3.321    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vinf)    0.079    0.017    4.753    0.000
    s       (vslf)    0.000    0.001    0.569    0.569
   .lone1    (res)    0.109    0.005   21.909    0.000
   .lone2    (res)    0.109    0.005   21.909    0.000
   .lone3    (res)    0.109    0.005   21.909    0.000
   .lone4    (res)    0.109    0.005   21.909    0.000
   .lone5    (res)    0.109    0.005   21.909    0.000</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 009_4_Multigroup LGCM M4 Free factor means and co/variances - M4</span></span>
<span><span class="va">multigroupM4</span> <span class="op">&lt;-</span> <span class="st">' i =~ 1*lone1 + 1*lone2 + 1*lone3 + 1*lone4 + 1*lone5</span></span>
<span><span class="st">           s =~ 0*lone1 + 1*lone2 + 3*lone3 + 4*lone4 + 6*lone5</span></span>
<span><span class="st">#Growth factor means freely estimated</span></span>
<span><span class="st">i ~ c(intm, intf)*1</span></span>
<span><span class="st">s ~ c(slpm, slpf)*1</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor variances freely estimated</span></span>
<span><span class="st">i ~~ c(vinm, vinf)*i</span></span>
<span><span class="st">s ~~ c(vslm, vslf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor covariances freely estimated</span></span>
<span><span class="st">i ~~ c(covm, covf)*s</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Residual variances of observed items freely estimated across groups but held equal within groups</span></span>
<span><span class="st">lone1 ~~ c(rsm, rsf)*lone1</span></span>
<span><span class="st">lone2 ~~ c(rsm, rsf)*lone2</span></span>
<span><span class="st">lone3 ~~ c(rsm, rsf)*lone3</span></span>
<span><span class="st">lone4 ~~ c(rsm, rsf)*lone4</span></span>
<span><span class="st">lone5 ~~ c(rsm, rsf)*lone5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_multigroupM4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">multigroupM4</span>, data <span class="op">=</span> <span class="va">data</span>, group <span class="op">=</span> <span class="st">"female"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan WARNING: group variable 'female' contains missing values</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 49 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20
  Number of equality constraints                     8

  Number of observations per group:               Used       Total
    0                                              178         222
    1                                              142         193

Model Test User Model:
                                                      
  Test statistic                               178.403
  Degrees of freedom                                28
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    0                                           87.439
    1                                           90.964

Model Test Baseline Model:

  Test statistic                               463.335
  Degrees of freedom                                20
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.661
  Tucker-Lewis Index (TLI)                       0.758

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -762.185
  Loglikelihood unrestricted model (H1)       -672.984
                                                      
  Akaike (AIC)                                1548.371
  Bayesian (BIC)                              1593.591
  Sample-size adjusted Bayesian (SABIC)       1555.529

Root Mean Square Error of Approximation:

  RMSEA                                          0.183
  90 Percent confidence interval - lower         0.158
  90 Percent confidence interval - upper         0.209
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.172

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [0]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s       (covm)   -0.014    0.004   -3.668    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intm)    1.550    0.036   43.187    0.000
    s       (slpm)   -0.031    0.006   -4.949    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vinm)    0.163    0.025    6.632    0.000
    s       (vslm)    0.001    0.001    1.842    0.065
   .lone1    (rsm)    0.121    0.007   16.340    0.000
   .lone2    (rsm)    0.121    0.007   16.340    0.000
   .lone3    (rsm)    0.121    0.007   16.340    0.000
   .lone4    (rsm)    0.121    0.007   16.340    0.000
   .lone5    (rsm)    0.121    0.007   16.340    0.000


Group 2 [1]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    lone1             1.000                           
    lone2             1.000                           
    lone3             1.000                           
    lone4             1.000                           
    lone5             1.000                           
  s =~                                                
    lone1             0.000                           
    lone2             1.000                           
    lone3             3.000                           
    lone4             4.000                           
    lone5             6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s       (covf)   -0.006    0.003   -2.146    0.032

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (intf)    1.401    0.031   44.901    0.000
    s       (slpf)   -0.020    0.006   -3.321    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    i       (vinf)    0.087    0.017    5.217    0.000
    s       (vslf)    0.001    0.001    1.565    0.118
   .lone1    (rsf)    0.093    0.006   14.595    0.000
   .lone2    (rsf)    0.093    0.006   14.595    0.000
   .lone3    (rsf)    0.093    0.006   14.595    0.000
   .lone4    (rsf)    0.093    0.006   14.595    0.000
   .lone5    (rsf)    0.093    0.006   14.595    0.000</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="nested-model-comparisons-in-the-multigroup-lgcm" class="level2"><h2 class="anchored" data-anchor-id="nested-model-comparisons-in-the-multigroup-lgcm">Nested model comparisons in the Multigroup LGCM</h2>
<p>Models 9_1, 9_2, 9_3 and 9_4 can be compared since the first three are all nested in Model 9_4 (i.e., they are reduced or constrained forms of the full model in Model 9_4), and the first two are nested in Model 9_3 with Model 9_1 also nested in Model 9_2. The same approach for selecting the best-fitting model as in the comparisons of Models 1, 2, and 3 is employed here too.</p>
<p>If the LRT or the <span class="math inline">\(\chi^2\)</span> difference is significant (<span class="math inline">\(p &lt; .05\)</span>), it means that the full model fits the data significant better than the reduced or constrained model.</p>
<p>The constraints in each of the models have implications for how the results are interpreted in the multigroup approach,. Following are the sequence of testing in the multigroup approach.</p>
<ul>
<li>
M1: Constrain all parameters (growth factor means, growth factor variances and covariances, and residual variances) to be identical across groups
</li>
<li>
M2: Freely estimate growth factor means across groups, while keeping constraints on the growth factor variances and covariance, and residual variances
</li>
<li>
M3: Freely estimate growth factor means, growth factor variances and covariances, while keeping the constraints on the residual variances
</li>
<li>
M4: Freely estimate growth factor means, growth factor variances and covariances, and residual variances across the groups
</li>
</ul>
<p>In the first model (Model 9_1 or M1), it is assumed that both groups have the same growth function and shape, along with the same magnitude of variation in the growth factors and within-person deviations from the growth function.</p>
<p>That is to say, both groups have equal initial (starting) level and rate of change in loneliness as well as equal inter-individual differences in the initial level and rate of change as well as equal within-person variability around individual trajectories (or in the time-specific deviations from the rate of change).</p>
<p>In the second model (Model 9_2 or M2), the growth factors means are freely estimated while keeping all the other constraints or assumptions. Thus, the second model suggests that the groups have unequal initial level and rate of change.</p>
<p>In the third mode (Model 9_3 or M3), inter-individual or between-person differences in the initial level, the rate of change, and the correlation between the initial level and rate of change are now also freely estimated - indicating that both groups have different initial level, rate of change and the correlation between them.</p>
<p>Finally, Model 9_4 or M4, indicates that in addition to both groups having different initial level, rate of change and the correlation between them, within-person variability around individual trajectories are also different between both groups.</p>
Here the comparisons tests the following
<ul>
<li>
M1 vs.&nbsp;M2: Tests whether the both groups differ in their initial level and average trajectory or rate of change
</li>
<li>
M2 vs.&nbsp;M3: Tests the extent of inter-individual or between-person differences in the initial level and rate of change in both groups
</li>
<li>
M3 vs.&nbsp;M4: Tests the extent of within-person variability around individual trajectories
</li>
</ul>
<p>If all models fit equally well (i.e., no significant results from the LRT or <span class="math inline">\(\chi^2\)</span> difference is not significant (<span class="math inline">\(p &gt; .05\)</span>)) then choose the model with the smallest number of parameters, M1 – most parsimonious model as it is the most constrained/reduced model.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#The `anova` function in `lavaan` computes the LRT for nested models.</span></span>
<span><span class="va">compare_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_multigroupM1</span>, <span class="va">fit_multigroupM2</span>, <span class="va">fit_multigroupM3</span>, <span class="va">fit_multigroupM4</span><span class="op">)</span></span>
<span><span class="va">compare_groups</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

                 Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)
fit_multigroupM4 28 1548.4 1593.6 178.40                                      
fit_multigroupM3 29 1554.4 1595.9 186.45     8.0442 0.20983       1   0.004565
fit_multigroupM2 32 1558.5 1588.7 196.54    10.0956 0.12158       3   0.017771
fit_multigroupM1 34 1565.5 1588.1 207.48    10.9344 0.16709       2   0.004223
                   
fit_multigroupM4   
fit_multigroupM3 **
fit_multigroupM2 * 
fit_multigroupM1 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The LRT or the <span class="math inline">\(\chi^2\)</span> difference test returned significant results for all three tests, suggesting that the full model (Model 9_4 or M4) is best fitting model in this case.</p>
<p>Substantively, this means that both groups (males and females) differ in their average initial level and growth trajectories of loneliness, the extent of between-person differences in those trajectories and the extent of variability around their individual trajectories.</p>
<p>Using Model 9_4 or M4, we can test whether the differences are significant as follows</p>
</section><section id="test-of-parameter-constraints" class="level2"><h2 class="anchored" data-anchor-id="test-of-parameter-constraints">Test of parameter constraints</h2>
<p>First we test whether the intercept growth factors in both groups are significantly different</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constint</span> <span class="op">=</span> <span class="st">'intm - intf == 0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constint</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 9.911781

$df
[1] 1

$p.value
[1] 0.001642241

$se
[1] "standard"</code></pre>
</div>
</div>
<p>Then we also test whether the slope growth factors in both groups are significantly different</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constslp</span> <span class="op">=</span> <span class="st">'slpm - slpf ==0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constslp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 1.494709

$df
[1] 1

$p.value
[1] 0.2214873

$se
[1] "standard"</code></pre>
</div>
</div>
<p>Test significant difference between groups in the variability around intercept</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constint_var</span> <span class="op">=</span> <span class="st">'vinm - vinf == 0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constint_var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 6.502546

$df
[1] 1

$p.value
[1] 0.01077202

$se
[1] "standard"</code></pre>
</div>
</div>
<p>Test significant difference between groups in the variability around slope</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constslp_var</span> <span class="op">=</span> <span class="st">'vslm - vslf == 0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constslp_var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 0.14985

$df
[1] 1

$p.value
[1] 0.6986788

$se
[1] "standard"</code></pre>
</div>
</div>
<p>Test significant difference between groups in the variability around the relationship between intercept and slope</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constslp_cov_var</span> <span class="op">=</span> <span class="st">'covm - covf == 0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constslp_cov_var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 2.797878

$df
[1] 1

$p.value
[1] 0.09438918

$se
[1] "standard"</code></pre>
</div>
</div>
<p>Test significant difference between groups in the residual variability</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">constslp_res_var</span> <span class="op">=</span> <span class="st">'rsm - rsf == 0'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavTestWald.html">lavTestWald</a></span><span class="op">(</span><span class="va">fit_multigroupM4</span>, constraints <span class="op">=</span> <span class="va">constslp_res_var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$stat
[1] 8.154299

$df
[1] 1

$p.value
[1] 0.004295919

$se
[1] "standard"</code></pre>
</div>
</div>
</section><section id="modelling-co-development-and-multivariate-growth-models" class="level2"><h2 class="anchored" data-anchor-id="modelling-co-development-and-multivariate-growth-models">Modelling co-development and Multivariate growth models</h2>
<p>Modelling the co-development among different attributes such as the comorbidity of anxiety and depression is becoming more common. <em>Multivariate growth models</em> also called <em>Parallel growth models</em> can accommodate different growth functions among two or more attributes.</p>
<p>Care must be taken and theoretical considerations must be prioritized when choosing between <em>Multivariate growth curve models</em> and the <em>Growth curve models with time-varying covariates</em>.</p>
<p>The two are related but answer different research questions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Model 10_1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Model 10_2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Model 10_3</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 010_1_Parallel growth curve models - anxiety and depression symptoms</span></span>
<span><span class="va">parallel</span> <span class="op">&lt;-</span> <span class="st">' ia =~ 1*anx1 + 1*anx2 + 1*anx3 + 1*anx4 + 1*anx5</span></span>
<span><span class="st">                sa =~ 0*anx1 + 1*anx2 + 3*anx3 + 4*anx4 + 6*anx5</span></span>
<span><span class="st">                id =~ 1*dep1 + 1*dep2 + 1*dep3 + 1*dep4 + 1*dep5</span></span>
<span><span class="st">                sd =~ 0*dep1 + 1*dep2 + 3*dep3 + 4*dep4 + 6*dep5</span></span>
<span><span class="st">#Growth factor corelations </span></span>
<span><span class="st">ia ~~ id + sa</span></span>
<span><span class="st">sd ~~ id + sa</span></span>
<span><span class="st">ia ~~ 0*sd </span></span>
<span><span class="st">id ~~ 0*sa</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_parallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">parallel</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_parallel</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 88 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        22

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               820.887
  Degrees of freedom                                43
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              1912.994
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.584
  Tucker-Lewis Index (TLI)                       0.564

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1711.078
  Loglikelihood unrestricted model (H1)      -1300.634
                                                      
  Akaike (AIC)                                3466.156
  Bayesian (BIC)                              3549.128
  Sample-size adjusted Bayesian (SABIC)       3479.347

Root Mean Square Error of Approximation:

  RMSEA                                          0.237
  90 Percent confidence interval - lower         0.223
  90 Percent confidence interval - upper         0.252
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.357

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia =~                                               
    anx1              1.000                           
    anx2              1.000                           
    anx3              1.000                           
    anx4              1.000                           
    anx5              1.000                           
  sa =~                                               
    anx1              0.000                           
    anx2              1.000                           
    anx3              3.000                           
    anx4              4.000                           
    anx5              6.000                           
  id =~                                               
    dep1              1.000                           
    dep2              1.000                           
    dep3              1.000                           
    dep4              1.000                           
    dep5              1.000                           
  sd =~                                               
    dep1              0.000                           
    dep2              1.000                           
    dep3              3.000                           
    dep4              4.000                           
    dep5              6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia ~~                                               
    id                0.125    0.012   10.436    0.000
    sa                0.000    0.002    0.109    0.913
  id ~~                                               
    sd                0.005    0.002    2.216    0.027
  sa ~~                                               
    sd                0.004    0.000    9.146    0.000
  ia ~~                                               
    sd                0.000                           
  sa ~~                                               
    id                0.000                           

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    ia                1.397    0.022   64.889    0.000
    sa               -0.032    0.004   -7.842    0.000
    id                1.545    0.027   56.861    0.000
    sd               -0.014    0.005   -2.825    0.005

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .anx1              0.083    0.010    8.647    0.000
   .anx2              0.122    0.011   11.095    0.000
   .anx3              0.148    0.012   11.878    0.000
   .anx4              0.103    0.009   11.541    0.000
   .anx5              0.062    0.008    7.615    0.000
   .dep1              0.103    0.012    8.309    0.000
   .dep2              0.149    0.014   10.787    0.000
   .dep3              0.241    0.020   11.889    0.000
   .dep4              0.181    0.016   11.601    0.000
   .dep5              0.156    0.017    9.292    0.000
    ia                0.097    0.012    8.393    0.000
    sa                0.002    0.000    3.997    0.000
    id                0.171    0.019    8.956    0.000
    sd                0.002    0.001    2.954    0.003</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 010_2_Parallel growth curve models - anxiety and depression symptoms with autocorrelations</span></span>
<span><span class="va">parallelautocor</span> <span class="op">&lt;-</span> <span class="st">' ia =~ 1*anx1 + 1*anx2 + 1*anx3 + 1*anx4 + 1*anx5</span></span>
<span><span class="st">                sa =~ 0*anx1 + 1*anx2 + 3*anx3 + 4*anx4 + 6*anx5</span></span>
<span><span class="st">                id =~ 1*dep1 + 1*dep2 + 1*dep3 + 1*dep4 + 1*dep5</span></span>
<span><span class="st">                sd =~ 0*dep1 + 1*dep2 + 3*dep3 + 4*dep4 + 6*dep5</span></span>
<span><span class="st">#Growth factor corelations </span></span>
<span><span class="st">ia ~~ id + sa</span></span>
<span><span class="st">sd ~~ id + sa</span></span>
<span><span class="st">ia ~~ 0*sd </span></span>
<span><span class="st">id ~~ 0*sa</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Autocorrelations </span></span>
<span><span class="st">anx1 ~~ anx2</span></span>
<span><span class="st">anx2 ~~ anx3</span></span>
<span><span class="st">anx3 ~~ anx4</span></span>
<span><span class="st">anx4 ~~ anx5</span></span>
<span><span class="st"></span></span>
<span><span class="st">dep1 ~~ dep2</span></span>
<span><span class="st">dep2 ~~ dep3</span></span>
<span><span class="st">dep3 ~~ dep4</span></span>
<span><span class="st">dep4 ~~ dep5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_parallelautocor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">parallelautocor</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: covariance matrix of latent variables
                is not positive definite;
                use lavInspect(fit, "cov.lv") to investigate.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_parallelautocor</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 97 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        30

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               797.045
  Degrees of freedom                                35
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              1912.994
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.592
  Tucker-Lewis Index (TLI)                       0.475

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1699.157
  Loglikelihood unrestricted model (H1)      -1300.634
                                                      
  Akaike (AIC)                                3458.314
  Bayesian (BIC)                              3571.457
  Sample-size adjusted Bayesian (SABIC)       3476.302

Root Mean Square Error of Approximation:

  RMSEA                                          0.260
  90 Percent confidence interval - lower         0.245
  90 Percent confidence interval - upper         0.276
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.337

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia =~                                               
    anx1              1.000                           
    anx2              1.000                           
    anx3              1.000                           
    anx4              1.000                           
    anx5              1.000                           
  sa =~                                               
    anx1              0.000                           
    anx2              1.000                           
    anx3              3.000                           
    anx4              4.000                           
    anx5              6.000                           
  id =~                                               
    dep1              1.000                           
    dep2              1.000                           
    dep3              1.000                           
    dep4              1.000                           
    dep5              1.000                           
  sd =~                                               
    dep1              0.000                           
    dep2              1.000                           
    dep3              3.000                           
    dep4              4.000                           
    dep5              6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia ~~                                               
    id                0.120    0.012   10.344    0.000
    sa                0.004    0.002    1.529    0.126
  id ~~                                               
    sd                0.007    0.004    1.748    0.080
  sa ~~                                               
    sd                0.004    0.000    9.109    0.000
  ia ~~                                               
    sd                0.000                           
  sa ~~                                               
    id                0.000                           
 .anx1 ~~                                             
   .anx2              0.021    0.011    1.880    0.060
 .anx2 ~~                                             
   .anx3              0.032    0.009    3.402    0.001
 .anx3 ~~                                             
   .anx4             -0.000    0.008   -0.058    0.954
 .anx4 ~~                                             
   .anx5             -0.012    0.009   -1.262    0.207
 .dep1 ~~                                             
   .dep2              0.022    0.018    1.239    0.215
 .dep2 ~~                                             
   .dep3              0.027    0.013    2.045    0.041
 .dep3 ~~                                             
   .dep4              0.017    0.015    1.183    0.237
 .dep4 ~~                                             
   .dep5             -0.039    0.016   -2.440    0.015

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    ia                1.394    0.021   65.511    0.000
    sa               -0.032    0.004   -8.005    0.000
    id                1.543    0.027   57.239    0.000
    sd               -0.017    0.005   -3.386    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .anx1              0.102    0.015    6.870    0.000
   .anx2              0.145    0.014   10.330    0.000
   .anx3              0.162    0.014   11.832    0.000
   .anx4              0.091    0.010    9.176    0.000
   .anx5              0.049    0.013    3.626    0.000
   .dep1              0.116    0.023    5.122    0.000
   .dep2              0.173    0.020    8.867    0.000
   .dep3              0.252    0.022   11.625    0.000
   .dep4              0.161    0.018    9.108    0.000
   .dep5              0.119    0.025    4.742    0.000
    ia                0.073    0.015    4.804    0.000
    sa                0.002    0.001    2.197    0.028
    id                0.147    0.026    5.720    0.000
    sd                0.003    0.001    2.232    0.026</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 010_3_Parallel growth curve models - anxiety and depression symptoms with cross-domain correlations </span></span>
<span><span class="va">parallelcross</span> <span class="op">&lt;-</span> <span class="st">' ia =~ 1*anx1 + 1*anx2 + 1*anx3 + 1*anx4 + 1*anx5</span></span>
<span><span class="st">                sa =~ 0*anx1 + 1*anx2 + 3*anx3 + 4*anx4 + 6*anx5</span></span>
<span><span class="st">                id =~ 1*dep1 + 1*dep2 + 1*dep3 + 1*dep4 + 1*dep5</span></span>
<span><span class="st">                sd =~ 0*dep1 + 1*dep2 + 3*dep3 + 4*dep4 + 6*dep5</span></span>
<span><span class="st">#Growth factor corelations </span></span>
<span><span class="st">ia ~~ id + sa</span></span>
<span><span class="st">sd ~~ id + sa</span></span>
<span><span class="st">ia ~~ 0*sd </span></span>
<span><span class="st">id ~~ 0*sa</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Cross domain correlations</span></span>
<span><span class="st">anx1 ~~ dep1</span></span>
<span><span class="st">anx2 ~~ dep2</span></span>
<span><span class="st">anx3 ~~ dep3</span></span>
<span><span class="st">anx4 ~~ dep4</span></span>
<span><span class="st">anx5 ~~ dep5</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_parallelcross</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">parallelcross</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_parallelcross</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 103 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               161.219
  Degrees of freedom                                38
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              1912.994
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.934
  Tucker-Lewis Index (TLI)                       0.922

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1381.244
  Loglikelihood unrestricted model (H1)      -1300.634
                                                      
  Akaike (AIC)                                2816.487
  Bayesian (BIC)                              2918.316
  Sample-size adjusted Bayesian (SABIC)       2832.676

Root Mean Square Error of Approximation:

  RMSEA                                          0.101
  90 Percent confidence interval - lower         0.085
  90 Percent confidence interval - upper         0.117
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.983

Standardized Root Mean Square Residual:

  SRMR                                           0.122

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia =~                                               
    anx1              1.000                           
    anx2              1.000                           
    anx3              1.000                           
    anx4              1.000                           
    anx5              1.000                           
  sa =~                                               
    anx1              0.000                           
    anx2              1.000                           
    anx3              3.000                           
    anx4              4.000                           
    anx5              6.000                           
  id =~                                               
    dep1              1.000                           
    dep2              1.000                           
    dep3              1.000                           
    dep4              1.000                           
    dep5              1.000                           
  sd =~                                               
    dep1              0.000                           
    dep2              1.000                           
    dep3              3.000                           
    dep4              4.000                           
    dep5              6.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia ~~                                               
    id                0.075    0.009    8.272    0.000
    sa               -0.004    0.001   -2.790    0.005
  id ~~                                               
    sd               -0.002    0.002   -1.204    0.229
  sa ~~                                               
    sd                0.000    0.000    1.208    0.227
  ia ~~                                               
    sd                0.000                           
  sa ~~                                               
    id                0.000                           
 .anx1 ~~                                             
   .dep1              0.082    0.011    7.655    0.000
 .anx2 ~~                                             
   .dep2              0.105    0.012    8.565    0.000
 .anx3 ~~                                             
   .dep3              0.130    0.015    8.939    0.000
 .anx4 ~~                                             
   .dep4              0.103    0.011    8.982    0.000
 .anx5 ~~                                             
   .dep5              0.056    0.011    4.900    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    ia                1.394    0.021   66.266    0.000
    sa               -0.031    0.004   -7.868    0.000
    id                1.548    0.026   59.272    0.000
    sd               -0.013    0.005   -2.773    0.006

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .anx1              0.109    0.012    9.157    0.000
   .anx2              0.137    0.013   10.704    0.000
   .anx3              0.154    0.013   11.374    0.000
   .anx4              0.106    0.010   10.746    0.000
   .anx5              0.056    0.010    5.820    0.000
   .dep1              0.134    0.015    8.954    0.000
   .dep2              0.171    0.016   10.473    0.000
   .dep3              0.241    0.021   11.262    0.000
   .dep4              0.187    0.017   10.745    0.000
   .dep5              0.158    0.020    7.910    0.000
    ia                0.080    0.010    8.242    0.000
    sa                0.001    0.000    3.065    0.002
    id                0.138    0.016    8.787    0.000
    sd                0.001    0.001    1.222    0.222</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="sequentially-contingent-growth-models" class="level2"><h2 class="anchored" data-anchor-id="sequentially-contingent-growth-models">Sequentially contingent growth models</h2>
<p>Growth in one attribute can predict the growth that occur in another attribute later in the developmental process. The rate of change in language development during pre-school may predict the rate of change in language skills during primary school. <em>Sequentially contingent growth models</em> offer flexibility in modelling such relations in the developmental process that occur in different stages, but might be contingent on each other.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Model 11</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 011_ Sequentially contingent growth curve model anxiety t1-t5 predicting depression t6-t10</span></span>
<span><span class="va">sequential</span> <span class="op">&lt;-</span> <span class="st">' ia =~ 1*anx1 + 1*anx2 + 1*anx3 + 1*anx4 + 1*anx5</span></span>
<span><span class="st">                sa =~ 0*anx1 + 1*anx2 + 3*anx3 + 4*anx4 + 6*anx5</span></span>
<span><span class="st">                id =~ 1*dep6 + 1*dep7 + 1*dep8 + 1*dep9 + 1*dep10</span></span>
<span><span class="st">                sd =~ 0*dep6 + 1*dep7 + 2*dep8 + 3*dep9 + 4*dep10</span></span>
<span><span class="st">#Growth factor corelations </span></span>
<span><span class="st">ia ~~ sa</span></span>
<span><span class="st">id ~~ sd</span></span>
<span><span class="st">ia ~~ 0*sd </span></span>
<span><span class="st">id ~~ 0*sa</span></span>
<span><span class="st"></span></span>
<span><span class="st">#Growth factor regressions of depression on anxiety symptoms</span></span>
<span><span class="st">id ~ ia</span></span>
<span><span class="st">sd ~ sa</span></span>
<span><span class="st">'</span></span>
<span><span class="co">#Rename multiple columns using rename()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"dep6"</span> <span class="op">=</span> <span class="st">"dep1"</span>,</span>
<span>         <span class="st">"dep7"</span> <span class="op">=</span> <span class="st">"dep2"</span>,</span>
<span>         <span class="st">"dep8"</span> <span class="op">=</span> <span class="st">"dep3"</span>,</span>
<span>         <span class="st">"dep9"</span> <span class="op">=</span> <span class="st">"dep4"</span>,</span>
<span>         <span class="st">"dep10"</span> <span class="op">=</span> <span class="st">"dep5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_sequential</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/growth.html">growth</a></span><span class="op">(</span><span class="va">sequential</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in lav_object_post_check(object): lavaan WARNING: some estimated lv
variances are negative</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_sequential</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 91 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        22

                                                  Used       Total
  Number of observations                           321         442

Model Test User Model:
                                                      
  Test statistic                               688.159
  Degrees of freedom                                43
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              1912.994
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.655
  Tucker-Lewis Index (TLI)                       0.639

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1644.714
  Loglikelihood unrestricted model (H1)      -1300.634
                                                      
  Akaike (AIC)                                3333.428
  Bayesian (BIC)                              3416.399
  Sample-size adjusted Bayesian (SABIC)       3346.619

Root Mean Square Error of Approximation:

  RMSEA                                          0.216
  90 Percent confidence interval - lower         0.202
  90 Percent confidence interval - upper         0.231
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.123

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia =~                                               
    anx1              1.000                           
    anx2              1.000                           
    anx3              1.000                           
    anx4              1.000                           
    anx5              1.000                           
  sa =~                                               
    anx1              0.000                           
    anx2              1.000                           
    anx3              3.000                           
    anx4              4.000                           
    anx5              6.000                           
  id =~                                               
    dep6              1.000                           
    dep7              1.000                           
    dep8              1.000                           
    dep9              1.000                           
    dep10             1.000                           
  sd =~                                               
    dep6              0.000                           
    dep7              1.000                           
    dep8              2.000                           
    dep9              3.000                           
    dep10             4.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  id ~                                                
    ia                1.377    0.067   20.520    0.000
  sd ~                                                
    sa                2.253    0.186   12.082    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  ia ~~                                               
    sa               -0.014    0.002   -7.039    0.000
 .id ~~                                               
   .sd                0.020    0.004    5.271    0.000
  ia ~~                                               
   .sd                0.000                           
  sa ~~                                               
   .id                0.000                           

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    ia                1.396    0.023   60.533    0.000
    sa               -0.032    0.005   -7.065    0.000
   .id               -0.371    0.096   -3.869    0.000
   .sd                0.049    0.010    5.111    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .anx1              0.077    0.008    9.449    0.000
   .anx2              0.122    0.011   11.411    0.000
   .anx3              0.151    0.013   11.961    0.000
   .anx4              0.103    0.009   11.598    0.000
   .anx5              0.052    0.007    7.836    0.000
   .dep6              0.115    0.013    8.699    0.000
   .dep7              0.148    0.013   11.037    0.000
   .dep8              0.241    0.020   11.845    0.000
   .dep9              0.185    0.016   11.602    0.000
   .dep10             0.141    0.015    9.496    0.000
    ia                0.122    0.013    9.684    0.000
    sa                0.003    0.000    7.331    0.000
   .id               -0.029    0.013   -2.301    0.021
   .sd               -0.011    0.002   -6.125    0.000</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Feel free to contact me at <a href="mailto:frederick.anyan@ntnu.no" class="email">frederick.anyan@ntnu.no</a> for advise or invitation to present workshops in your own institution.</p>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Made with <a href="https://quarto.org">Posit Quarto</a></div>   
    <div class="nav-footer-center"><a href="mailto:%20frederick.anyan@ntnu.no">Contact Frederick Anyan</a></div>
    <div class="nav-footer-right"><a href="https://github.com/frederickanyan">Github Repo</a></div>
  </div>
</footer>


</body></html>