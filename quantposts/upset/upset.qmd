---
title: 'Visualizing Sets'
author: "Frederick Anyan"
date: 2023-06-24
categories: [Sets, Venn diagram]
image: "ups.png"
---
Variables or columns are known as sets in upset visualization. Upset plots can be used to visualize the size and the pairwise combinations or intersections of sets and their aggregates. This facilitates easy-to-understand communication of the size and proportion of set memberships. 

## Example
<ul> Let's say you want to know the prevalence of disorders in your sample and co-morbidity across disorders. Upset plots can visualize the proportion of the sample who meet criteria for PTSD, depression and anxiety disorders, or other kinds of combinations of sorts. For example, the proportion of people who meet criteria for depression, but not anxiety disorders and PTSD, or the proportion who meet criteria for PTSD, but not depression and anxiety disorders, and several other combinations. </ul>

Data with multiple variables or their combinations is often displayed in a Venn diagram. In some cases the Euler diagram is used. Both have limitations with increasing number of variables or sets. Upset plots can be used to visualize the distributions of people for different variables or sets, their overlaps or intersections and their aggregates - for communicating the size and proportion of set memberships. 

In this tutorial post, we will see how to use the upset() function in the 'UpSetR' package to visualize intersecting sets.  

Load data
```{r}
data <- read.csv("/Volumes/anyan-1/dataupset.csv")#
#head(data) #first few rows
```

The data comes from the [Adolescent Stress Questionnaire scale](https://doi.org/10.1016/j.adolescence.2006.04.004) which contains 10 sub-scales, 8 of which will be used in this tutorial. 

The sub-scales are 
<ul>
 <li>Stress of School Attendance - _ssa_.</li> 
 <li>Stress of Romantic Relationships - _srr_.</li> 
 <li>Stress of Peer Pressure - _spp_.</li> 
 <li>Stress of Teacher Interaction - _stin_.</li> 
 <li>Stress of Future Uncertainty - _sfu_.</li> 
 <li>Stress of School/Leisure Conflict - _slc_.</li> 
 <li>Stress of Emerging Adult Responsibility - _sear_.</li> 
 <li>Stress of Home Life - _shl_.</li> 
 <li>Stress of School Performance - _ssp_.</li> 
 <li>Stress of Financial Pressure - _sfp_.</li> 
</ul>

For this tutorial, median split was used to categorize participants into two groups namely 'stressed' and 'not stressed' - with binary coding as 1 and 0. You can use established cut-off scores for your own data.

## UpSetR package 
```{r}
library(UpSetR) #Load the UpSetR package to access the upset () function
```

Now visualize the data using the upset() function. 
```{r}
upset(data,                      #Name of data file 
      #nsets = 8,                #To see all 8 sets in the upset plot
      matrix.color = "red", 
      sets.bar.color = "blue", 
      order.by = "freq"            #You can order sets by frequencies 
      ) 
```


The blue barchart shows the total size of the set (i.e., set size). 

The red filled-in circles corresponds to possible intersections or overlaps showing which set is part of an intersection or which variable overlaps with which other variable(s). For example, sfu and srr form an intersection or overlap, and so does srr and spp. Additionally, sfu, srr, spp and ssa also form an intersection. And so on... 

The black barchart correspond to the size or occurrence of possible intersections (i.e., intersection size).  


[Read more about upset plots](https://upset.app/advanced/) 